---
title: "Prep_ReadingPersistenceMeasure"
author: "Pauliina Vuorinen"
date: "26/09/2022-"
output: html_document
library: "~/Extra/RPackages.bib"
---

# Introduction

The purpose of this script is to create a measure of reading measure.

Reading persistence refers to the volume of reading, such as how many texts are read at a given time, or how far into a text one reads (and whether the text is read until completion or not). In the current study, persistence was measured by the furthest location that participants reached in the short story. This variable is continuous and numerical.

To find the furthest location each participant reached, we first measure the furthest location recorded in the tracking data, and then compare these locations to a plot of participants' reading progress. The comparison is done because participants could freely move around the story, and thus they could have jumped to the end, for example, to capture the length of the text. In measuring reading persistence, we are interested in the furthest point in the text that participants reached by reading it. The plot is created in Fig_ReadingProgressPlots.r which can be found in the Fig folder. The comparison of computed locations and progress plots is included in this script.

**Information on hypotheses:**
We expected that participants with autonomous situational motivation (and thus, high-autonomy condition) would be more likely to read the story further and finish it.

Similarly, we expected controlled autonomous motivation to be connected to higher reading persistence. Avid readers tend to have an internal locus of control, and therefore they are more likely to believe the outcomes of reading are contingent upon the effort they put into reading [@Keller2008]. In contrast, non-frequent readers are likely to have an external locus of control, and therefore, they are likely to assume that the effort they put into reading does not influence their enjoyment of the text. As a result, avid readers may be more likely to persist reading a text even if they do not feel involved in the story from the very beginning, whereas non-frequent readers may stop reading it earlier on. Considering that avid readers tend to have contextual autonomous motivation [XX], we expected that participants with contextual autonomous motivation would be more likely to continue reading the story for longer than participants with contextual controlled motivation.

Lastly, we expected reading persistence to be connected to participants' electronic reading experience. Participants with little electronic reading experience may have found it more difficult to engage in reading on an unfamiliar reading platform, whereas participants with more task-relevant electronic experience should have found it easier to continue reading on the e-reader. As a result, we expected that higher levels of task-relevant electronic experience is connected to reading persistence.

## Setup

```{r 'setup'}
library(tidyverse)
library(dplyr)
```

Save working directory so that this script can be used elsewhere, if required. The working directory should be "~/Short-Story-Reading-Behaviour-Public/". If the working directory is not correct, we save the correct path and use that in loading files. In our purposes, the foulder could be found from /Documents/GITHUB/Short_Story_Reading_Behaviour_Public.

The working directory is not changed with setwd() because this script is knit remotely in other scripts.

```{r 'working directory for my purposes'}
mypath_SSRBP <- getwd()
if (!grepl("Short_Story_Reading_Behaviour_Public", mypath_SSRBP, fixed = TRUE)) {
    # wrong working directory
    if (!grepl("GITHUB", dirname(mypath_SSRBP), fixed = TRUE)) {
        # directory name isn't GITHUB, unlike I would expect
        if (grepl("GITHUB", mypath_SSRBP, fixed = TRUE)) {
            # GITHUB is in the path
            ## use mypath_SSRBP instead of dirname()
            mypath_SSRBP <- paste0(
                mypath_SSRBP,
                "/Short_Story_Reading_Behaviour_Public"
            )
        }
    } else {
        # directory name is GITHUB
        # save correct working directory
        mypath_SSRBP <- paste0(
            dirname(mypath_SSRBP),
            "/Short_Story_Reading_Behaviour_Public"
        )
    }
}
```

## Load data and check variable types

We use a dataset that was created and saved at the end of Prep_TrackingDataWrangling.rmd:

```{r 'load data'}
tracking_data <-
    read.csv(
        paste0(
            mypath_SSRBP,
            "/Data/wrangled_tracking_data.csv"
        ),
        header = TRUE,
        sep = ";",
        dec = ","
    )
tracking_data <- dplyr::select(tracking_data, -X)
```


```{r 'change variable types'}
str(tracking_data)
source(
    paste0(
        mypath_SSRBP,
        "/Functions/Functions_VariableTypeConversion.R"
    ),
)

## turn columns into factors that should be factors
tracking_data[, c(
    "UserId",
    "StoryId",
    "Direction",
    "NavigationBlockDirection"
)] <- convert.magic(
    tracking_data[, c(
        "UserId",
        "StoryId",
        "Direction",
        "NavigationBlockDirection"
    )],
    "factor"
)
## fix numeric columns that were automatically categorised as character
tracking_data[, c(
    "BaselineSpeed",
    "DurationMinutes",
    "ReadingBlockDuration",
    "EngagedReadingDuration",
    "EngagedReadingSpeed",
    "NavigationBlockDuration",
    "TimeBeforeDeadlinesDays"
)] <- convert.magic(
    tracking_data[, c(
        "BaselineSpeed",
        "DurationMinutes",
        "ReadingBlockDuration",
        "EngagedReadingDuration",
        "EngagedReadingSpeed",
        "NavigationBlockDuration",
        "TimeBeforeDeadlinesDays"
    )],
    "numeric"
)
## turn reading block (page view) number,
### reading session number, and
#### navigation block number into ordered factors
tracking_data[, c(
    "ReadingBlockNumber",
    "ReadingSessionNumber",
    "NavigationBlockNumber"
)] <- convert.magic(
    tracking_data[, c(
        "ReadingBlockNumber",
        "ReadingSessionNumber",
        "NavigationBlockNumber"
    )],
    "ordered"
)
## fix logical variables
tracking_data[, c(
    "IsBlurred",
    "IsDialogOpen",
    "IsMenuOpen",
    "IsInactive",
    "IsReading",
    "IsPageOpen"
)] <- convert.magic(
    tracking_data[, c(
        "IsBlurred",
        "IsDialogOpen",
        "IsMenuOpen",
        "IsInactive",
        "IsReading",
        "IsPageOpen"
    )],
    "logical"
)

## fix date and time variable types
tracking_data$Date <-
    as.Date(
        tracking_data$Date,
        format = "%Y-%m-%d"
    )
TempTimeObject <- strsplit(tracking_data$Time, " ")
TempTimeObject <- sapply(TempTimeObject, "[[", 2)
tracking_data$TempTimeObject <- TempTimeObject
tracking_data <- dplyr::select(tracking_data, -Time)
names(tracking_data)[which(colnames(tracking_data) == "TempTimeObject")] <- "Time"
tracking_data$DateTime <- paste(
    tracking_data$Date,
    tracking_data$Time
)
op <-
    options(digits.secs = 3)
tracking_data$Time <-
    strptime(
        tracking_data$Time,
        format = "%H:%M:%OS"
    )
tracking_data <- tracking_data %>%
    mutate(DateTime = as.POSIXct(DateTime, format = "%Y-%m-%d %H:%M:%OS"))
```

## Reading persistence measure

We create a summary dataframe to compute 'FurthestPercentage' which shows the furthest location in the story that the participants reached.

```{r 'create a summary df'}
reading_persistence_summary <- tracking_data %>%
    group_by(UserId, StoryId, Condition) %>%
    summarise(
        FurthestPercentage = max(Percentage, na.rm = TRUE),
        DaysUntilDeadline = last(TimeBeforeDeadlinesDays)
    )
```

On average the FurthestPercentage reached was `r round(mean(reading_persistence_summary$FurthestPercentage)*100, 2)`%, *SD* = `r round(sd(reading_persistence_summary$FurthestPercentage)*100, 2)`% Indeed, `r sum(reading_persistence_summary$FurthestPercentage > .9)` of the `r length(unique(reading_persistence_summary$UserId)` participants reached a location further than 90% into the short story. The remaining `r length(unique(reading_persistence_summary$UserId)) - sum(reading_persistence_summary$FurthestPercentage > .9)` participants read until `r (reading_persistence_summary[reading_persistence_summary$FurthestPercentage < .9, "FurthestPercentage"])*100` in the text.

### Comparison to progress plots

We compare the FurthestPercentage to Fig_ProgressGraphGroupedByParticipant.png (in Fig folder).
The figure is printed below:

```{r}
knitr::include_graphics(
    paste0(
        mypath_SSRBP,
        "/Fig/Fig_ProgressGraphGroupedByParticipant.png"
    )
)
```

The figure shows each participants' reading progress with location in story (in percentages) on the x-axis and cumulative time spent reading (in minutes) on the y-axis. Each facet represents a single participant, with each participants' reading progress also colour coded.

If a participant read the story until the end, the line in their facet should be close to 100%, or the maximum x-value which is represented by the second, faint, vertical line in the graph. The slope of the line indicates a participant's reading speed - and therefore, any jumps around the book or rapid turning of pages is shown as a horizontal line in the graph. If a participant finished the story, their line in a facet should reach the maximum x-value by slope rather than a horizontal line.

Inspection of the graph indicates that all but two participants reached the end of the short story, and these participants' progress to the end is not shown as a horizontal line. The remaining two participants seem to have reached 10-20% and 45-55% of the way through the story. These observations are in line with FurthestPercentage, and thus FurthestPercentage is deemed to be a good measure of reading persistence.

## Reading Persistence Findings

Considering that only two participants did not finish reading the story, the reading persistence analysis cannot be conducted. The two participants who did not finish belong to different conditions (`r reading_persistence_summary[reading_persistence_summary$FurthestPercentage < .9, "Condition"]`). This indicates that our hypotheses on the influence of situational motivation on persistence were not supported.

Reading persistence may have been so high because of the short length of the stories. See more information in the Discussion section of the manuscript.
